{"version":3,"sources":["webpack://circuitBreaker/webpack/universalModuleDefinition","webpack://circuitBreaker/webpack/bootstrap","webpack://circuitBreaker/./node_modules/console-browserify/index.js","webpack://circuitBreaker/(webpack)/buildin/global.js","webpack://circuitBreaker/./node_modules/util/util.js","webpack://circuitBreaker/./node_modules/events/events.js","webpack://circuitBreaker/./index.js","webpack://circuitBreaker/./lib/circuit.js","webpack://circuitBreaker/./node_modules/process/browser.js","webpack://circuitBreaker/./node_modules/util/support/isBufferBrowser.js","webpack://circuitBreaker/./node_modules/util/node_modules/inherits/inherits_browser.js","webpack://circuitBreaker/./node_modules/assert/assert.js","webpack://circuitBreaker/./node_modules/object-assign/index.js","webpack://circuitBreaker/./lib/status.js","webpack://circuitBreaker/./lib/semaphore.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","util","assert","now","Date","getTime","console","slice","Array","times","global","functions","log","apply","arguments","warn","label","time","Error","duration","err","message","format","error","stack","inspect","expression","arr","ok","length","tuple","f","g","this","Function","e","getOwnPropertyDescriptors","obj","keys","descriptors","getOwnPropertyDescriptor","formatRegExp","isString","objects","push","join","args","len","str","String","replace","x","Number","JSON","stringify","_","isNull","isObject","deprecate","fn","msg","process","noDeprecation","warned","throwDeprecation","traceDeprecation","trace","debugEnviron","debugs","opts","ctx","seen","stylize","stylizeNoColor","depth","colors","isBoolean","showHidden","_extend","isUndefined","customInspect","stylizeWithColor","formatValue","styleType","style","styles","recurseTimes","isFunction","constructor","ret","primitive","simple","isNumber","formatPrimitive","visibleKeys","array","hash","forEach","val","idx","arrayToHash","getOwnPropertyNames","isError","indexOf","formatError","isRegExp","RegExp","toString","isDate","output","base","braces","isArray","toUTCString","formatProperty","match","formatArray","map","pop","reduce","prev","cur","numLinesEst","reduceToSingleString","desc","set","split","line","substr","ar","arg","re","objectToString","pad","debuglog","NODE_DEBUG","toUpperCase","test","pid","isNullOrUndefined","isSymbol","isPrimitive","isBuffer","months","timestamp","getHours","getMinutes","getSeconds","getDate","getMonth","prop","inherits","origin","add","kCustomPromisifiedSymbol","undefined","callbackifyOnRejected","reason","cb","newReason","promisify","original","TypeError","writable","configurable","promiseResolve","promiseReject","promise","Promise","resolve","reject","setPrototypeOf","getPrototypeOf","defineProperties","custom","callbackify","callbackified","maybeCb","self","then","nextTick","rej","ReflectOwnKeys","R","Reflect","ReflectApply","target","receiver","ownKeys","getOwnPropertySymbols","concat","NumberIsNaN","isNaN","EventEmitter","init","once","emitter","errorListener","removeListener","resolver","eventTargetAgnosticAddListener","handler","flags","on","addErrorHandlerIfEventEmitter","_events","_eventsCount","_maxListeners","defaultMaxListeners","checkListener","listener","_getMaxListeners","that","_addListener","type","prepend","events","existing","warning","newListener","emit","unshift","w","count","onceWrapper","fired","wrapFn","_onceWrap","state","wrapped","_listeners","unwrap","evlistener","unwrapListeners","arrayClone","listenerCount","copy","addEventListener","wrapListener","removeEventListener","RangeError","setMaxListeners","getMaxListeners","doError","er","context","listeners","addListener","prependListener","prependOnceListener","list","position","originalListener","shift","index","spliceOne","off","removeAllListeners","rawListeners","eventNames","require","Status","Semaphore","STATE","OPEN","CLOSED","HALF_OPEN","PENDING_CLOSE","SHUTDOWN","FALLBACK_FUNCTION","STATUS","NAME","GROUP","CACHE","WeakMap","ENABLED","WARMING_UP","VOLUME_THRESHOLD","OUR_ERROR","RESET_TIMEOUT","WARMUP_TIMEOUT","deprecation","CircuitBreaker","action","options","timeout","resetTimeout","errorThresholdPercentage","rollingCountTimeout","rollingCountBuckets","rollingPercentilesEnabled","capacity","isInteger","MAX_SAFE_INTEGER","errorFilter","semaphore","volumeThreshold","allowWarmUp","status","stats","enabled","warmUp","closed","halfOpen","shutdown","nextName","group","timer","setTimeout","unref","maxFailures","increment","result","runTime","_startTimer","circuit","open","close","cache","clearTimeout","disable","opened","isShutdown","func","fb","fire","buildError","rest","pendingClose","fallback","timeoutError","latencyStartTime","latency","release","handleError","latencyEndTime","interval","check","setInterval","fires","failures","fail","code","Math","random","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","currentQueue","queue","draining","queueIndex","cleanUpNextTick","drainQueue","run","marker","runClearTimeout","Item","noop","title","browser","env","argv","version","versions","binding","cwd","chdir","dir","umask","fill","readUInt8","ctor","superCtor","super_","TempCtor","objectAssign","compare","a","b","y","min","Buffer","_isBuffer","hasOwn","pSlice","functionsHaveNames","pToString","isView","arrbuf","ArrayBuffer","DataView","buffer","regex","getName","truncate","something","rawname","actual","expected","operator","stackStartFunction","AssertionError","_deepEqual","strict","memos","source","multiline","lastIndex","ignoreCase","Float32Array","Float64Array","Uint8Array","actualIndex","actualVisitedObjects","aIsArgs","isArguments","bIsArgs","ka","objectKeys","kb","sort","objEquiv","expectedException","isPrototypeOf","_throws","shouldThrow","block","_tryBlock","userProvidedMessage","isUnexpectedException","generatedMessage","captureStackTrace","out","fn_name","next_line","substring","equal","notEqual","deepEqual","deepStrictEqual","notDeepEqual","notDeepStrictEqual","strictEqual","notStrictEqual","throws","doesNotThrow","ifError","propIsEnumerable","propertyIsEnumerable","toObject","assign","test1","test2","fromCharCode","test3","letter","shouldUseNative","from","symbols","to","WINDOW","BUCKETS","TIMEOUT","PERCENTILES","BUCKET_INTERVAL","SNAPSHOT_INTERVAL","bucket","bucketInterval","floor","nextBucket","totals","acc","latencyTimes","latencyMean","percentile","percentiles","ceil","calculatePercentile","latencyRunTime","isCircuitBreakerOpen","clearInterval","fallbacks","successes","rejects","timeouts","cacheHits","cacheMisses","semaphoreRejections","resolvers","counter","sem","take"],"mappings":"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","file":"opossum.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"circuitBreaker\"] = factory();\n\telse\n\t\troot[\"circuitBreaker\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n","/*global window, global*/\nvar util = require(\"util\")\nvar assert = require(\"assert\")\nfunction now() { return new Date().getTime() }\n\nvar slice = Array.prototype.slice\nvar console\nvar times = {}\n\nif (typeof global !== \"undefined\" && global.console) {\n    console = global.console\n} else if (typeof window !== \"undefined\" && window.console) {\n    console = window.console\n} else {\n    console = {}\n}\n\nvar functions = [\n    [log, \"log\"],\n    [info, \"info\"],\n    [warn, \"warn\"],\n    [error, \"error\"],\n    [time, \"time\"],\n    [timeEnd, \"timeEnd\"],\n    [trace, \"trace\"],\n    [dir, \"dir\"],\n    [consoleAssert, \"assert\"]\n]\n\nfor (var i = 0; i < functions.length; i++) {\n    var tuple = functions[i]\n    var f = tuple[0]\n    var name = tuple[1]\n\n    if (!console[name]) {\n        console[name] = f\n    }\n}\n\nmodule.exports = console\n\nfunction log() {}\n\nfunction info() {\n    console.log.apply(console, arguments)\n}\n\nfunction warn() {\n    console.log.apply(console, arguments)\n}\n\nfunction error() {\n    console.warn.apply(console, arguments)\n}\n\nfunction time(label) {\n    times[label] = now()\n}\n\nfunction timeEnd(label) {\n    var time = times[label]\n    if (!time) {\n        throw new Error(\"No such label: \" + label)\n    }\n\n    delete times[label]\n    var duration = now() - time\n    console.log(label + \": \" + duration + \"ms\")\n}\n\nfunction trace() {\n    var err = new Error()\n    err.name = \"Trace\"\n    err.message = util.format.apply(null, arguments)\n    console.error(err.stack)\n}\n\nfunction dir(object) {\n    console.log(util.inspect(object) + \"\\n\")\n}\n\nfunction consoleAssert(expression) {\n    if (!expression) {\n        var arr = slice.call(arguments, 1)\n        assert.ok(false, util.format.apply(null, arr))\n    }\n}\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar getOwnPropertyDescriptors = Object.getOwnPropertyDescriptors ||\n  function getOwnPropertyDescriptors(obj) {\n    var keys = Object.keys(obj);\n    var descriptors = {};\n    for (var i = 0; i < keys.length; i++) {\n      descriptors[keys[i]] = Object.getOwnPropertyDescriptor(obj, keys[i]);\n    }\n    return descriptors;\n  };\n\nvar formatRegExp = /%[sdj%]/g;\nexports.format = function(f) {\n  if (!isString(f)) {\n    var objects = [];\n    for (var i = 0; i < arguments.length; i++) {\n      objects.push(inspect(arguments[i]));\n    }\n    return objects.join(' ');\n  }\n\n  var i = 1;\n  var args = arguments;\n  var len = args.length;\n  var str = String(f).replace(formatRegExp, function(x) {\n    if (x === '%%') return '%';\n    if (i >= len) return x;\n    switch (x) {\n      case '%s': return String(args[i++]);\n      case '%d': return Number(args[i++]);\n      case '%j':\n        try {\n          return JSON.stringify(args[i++]);\n        } catch (_) {\n          return '[Circular]';\n        }\n      default:\n        return x;\n    }\n  });\n  for (var x = args[i]; i < len; x = args[++i]) {\n    if (isNull(x) || !isObject(x)) {\n      str += ' ' + x;\n    } else {\n      str += ' ' + inspect(x);\n    }\n  }\n  return str;\n};\n\n\n// Mark that a method should not be used.\n// Returns a modified function which warns once by default.\n// If --no-deprecation is set, then it is a no-op.\nexports.deprecate = function(fn, msg) {\n  if (typeof process !== 'undefined' && process.noDeprecation === true) {\n    return fn;\n  }\n\n  // Allow for deprecating things in the process of starting up.\n  if (typeof process === 'undefined') {\n    return function() {\n      return exports.deprecate(fn, msg).apply(this, arguments);\n    };\n  }\n\n  var warned = false;\n  function deprecated() {\n    if (!warned) {\n      if (process.throwDeprecation) {\n        throw new Error(msg);\n      } else if (process.traceDeprecation) {\n        console.trace(msg);\n      } else {\n        console.error(msg);\n      }\n      warned = true;\n    }\n    return fn.apply(this, arguments);\n  }\n\n  return deprecated;\n};\n\n\nvar debugs = {};\nvar debugEnviron;\nexports.debuglog = function(set) {\n  if (isUndefined(debugEnviron))\n    debugEnviron = process.env.NODE_DEBUG || '';\n  set = set.toUpperCase();\n  if (!debugs[set]) {\n    if (new RegExp('\\\\b' + set + '\\\\b', 'i').test(debugEnviron)) {\n      var pid = process.pid;\n      debugs[set] = function() {\n        var msg = exports.format.apply(exports, arguments);\n        console.error('%s %d: %s', set, pid, msg);\n      };\n    } else {\n      debugs[set] = function() {};\n    }\n  }\n  return debugs[set];\n};\n\n\n/**\n * Echos the value of a value. Trys to print the value out\n * in the best way possible given the different types.\n *\n * @param {Object} obj The object to print out.\n * @param {Object} opts Optional options object that alters the output.\n */\n/* legacy: obj, showHidden, depth, colors*/\nfunction inspect(obj, opts) {\n  // default options\n  var ctx = {\n    seen: [],\n    stylize: stylizeNoColor\n  };\n  // legacy...\n  if (arguments.length >= 3) ctx.depth = arguments[2];\n  if (arguments.length >= 4) ctx.colors = arguments[3];\n  if (isBoolean(opts)) {\n    // legacy...\n    ctx.showHidden = opts;\n  } else if (opts) {\n    // got an \"options\" object\n    exports._extend(ctx, opts);\n  }\n  // set default options\n  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;\n  if (isUndefined(ctx.depth)) ctx.depth = 2;\n  if (isUndefined(ctx.colors)) ctx.colors = false;\n  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;\n  if (ctx.colors) ctx.stylize = stylizeWithColor;\n  return formatValue(ctx, obj, ctx.depth);\n}\nexports.inspect = inspect;\n\n\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\ninspect.colors = {\n  'bold' : [1, 22],\n  'italic' : [3, 23],\n  'underline' : [4, 24],\n  'inverse' : [7, 27],\n  'white' : [37, 39],\n  'grey' : [90, 39],\n  'black' : [30, 39],\n  'blue' : [34, 39],\n  'cyan' : [36, 39],\n  'green' : [32, 39],\n  'magenta' : [35, 39],\n  'red' : [31, 39],\n  'yellow' : [33, 39]\n};\n\n// Don't use 'blue' not visible on cmd.exe\ninspect.styles = {\n  'special': 'cyan',\n  'number': 'yellow',\n  'boolean': 'yellow',\n  'undefined': 'grey',\n  'null': 'bold',\n  'string': 'green',\n  'date': 'magenta',\n  // \"name\": intentionally not styling\n  'regexp': 'red'\n};\n\n\nfunction stylizeWithColor(str, styleType) {\n  var style = inspect.styles[styleType];\n\n  if (style) {\n    return '\\u001b[' + inspect.colors[style][0] + 'm' + str +\n           '\\u001b[' + inspect.colors[style][1] + 'm';\n  } else {\n    return str;\n  }\n}\n\n\nfunction stylizeNoColor(str, styleType) {\n  return str;\n}\n\n\nfunction arrayToHash(array) {\n  var hash = {};\n\n  array.forEach(function(val, idx) {\n    hash[val] = true;\n  });\n\n  return hash;\n}\n\n\nfunction formatValue(ctx, value, recurseTimes) {\n  // Provide a hook for user-specified inspect functions.\n  // Check that value is an object with an inspect function on it\n  if (ctx.customInspect &&\n      value &&\n      isFunction(value.inspect) &&\n      // Filter out the util module, it's inspect function is special\n      value.inspect !== exports.inspect &&\n      // Also filter out any prototype objects using the circular check.\n      !(value.constructor && value.constructor.prototype === value)) {\n    var ret = value.inspect(recurseTimes, ctx);\n    if (!isString(ret)) {\n      ret = formatValue(ctx, ret, recurseTimes);\n    }\n    return ret;\n  }\n\n  // Primitive types cannot have properties\n  var primitive = formatPrimitive(ctx, value);\n  if (primitive) {\n    return primitive;\n  }\n\n  // Look up the keys of the object.\n  var keys = Object.keys(value);\n  var visibleKeys = arrayToHash(keys);\n\n  if (ctx.showHidden) {\n    keys = Object.getOwnPropertyNames(value);\n  }\n\n  // IE doesn't make error fields non-enumerable\n  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx\n  if (isError(value)\n      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {\n    return formatError(value);\n  }\n\n  // Some type of object without properties can be shortcutted.\n  if (keys.length === 0) {\n    if (isFunction(value)) {\n      var name = value.name ? ': ' + value.name : '';\n      return ctx.stylize('[Function' + name + ']', 'special');\n    }\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    }\n    if (isDate(value)) {\n      return ctx.stylize(Date.prototype.toString.call(value), 'date');\n    }\n    if (isError(value)) {\n      return formatError(value);\n    }\n  }\n\n  var base = '', array = false, braces = ['{', '}'];\n\n  // Make Array say that they are Array\n  if (isArray(value)) {\n    array = true;\n    braces = ['[', ']'];\n  }\n\n  // Make functions say that they are functions\n  if (isFunction(value)) {\n    var n = value.name ? ': ' + value.name : '';\n    base = ' [Function' + n + ']';\n  }\n\n  // Make RegExps say that they are RegExps\n  if (isRegExp(value)) {\n    base = ' ' + RegExp.prototype.toString.call(value);\n  }\n\n  // Make dates with properties first say the date\n  if (isDate(value)) {\n    base = ' ' + Date.prototype.toUTCString.call(value);\n  }\n\n  // Make error with message first say the error\n  if (isError(value)) {\n    base = ' ' + formatError(value);\n  }\n\n  if (keys.length === 0 && (!array || value.length == 0)) {\n    return braces[0] + base + braces[1];\n  }\n\n  if (recurseTimes < 0) {\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    } else {\n      return ctx.stylize('[Object]', 'special');\n    }\n  }\n\n  ctx.seen.push(value);\n\n  var output;\n  if (array) {\n    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);\n  } else {\n    output = keys.map(function(key) {\n      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);\n    });\n  }\n\n  ctx.seen.pop();\n\n  return reduceToSingleString(output, base, braces);\n}\n\n\nfunction formatPrimitive(ctx, value) {\n  if (isUndefined(value))\n    return ctx.stylize('undefined', 'undefined');\n  if (isString(value)) {\n    var simple = '\\'' + JSON.stringify(value).replace(/^\"|\"$/g, '')\n                                             .replace(/'/g, \"\\\\'\")\n                                             .replace(/\\\\\"/g, '\"') + '\\'';\n    return ctx.stylize(simple, 'string');\n  }\n  if (isNumber(value))\n    return ctx.stylize('' + value, 'number');\n  if (isBoolean(value))\n    return ctx.stylize('' + value, 'boolean');\n  // For some reason typeof null is \"object\", so special case here.\n  if (isNull(value))\n    return ctx.stylize('null', 'null');\n}\n\n\nfunction formatError(value) {\n  return '[' + Error.prototype.toString.call(value) + ']';\n}\n\n\nfunction formatArray(ctx, value, recurseTimes, visibleKeys, keys) {\n  var output = [];\n  for (var i = 0, l = value.length; i < l; ++i) {\n    if (hasOwnProperty(value, String(i))) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          String(i), true));\n    } else {\n      output.push('');\n    }\n  }\n  keys.forEach(function(key) {\n    if (!key.match(/^\\d+$/)) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          key, true));\n    }\n  });\n  return output;\n}\n\n\nfunction formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {\n  var name, str, desc;\n  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };\n  if (desc.get) {\n    if (desc.set) {\n      str = ctx.stylize('[Getter/Setter]', 'special');\n    } else {\n      str = ctx.stylize('[Getter]', 'special');\n    }\n  } else {\n    if (desc.set) {\n      str = ctx.stylize('[Setter]', 'special');\n    }\n  }\n  if (!hasOwnProperty(visibleKeys, key)) {\n    name = '[' + key + ']';\n  }\n  if (!str) {\n    if (ctx.seen.indexOf(desc.value) < 0) {\n      if (isNull(recurseTimes)) {\n        str = formatValue(ctx, desc.value, null);\n      } else {\n        str = formatValue(ctx, desc.value, recurseTimes - 1);\n      }\n      if (str.indexOf('\\n') > -1) {\n        if (array) {\n          str = str.split('\\n').map(function(line) {\n            return '  ' + line;\n          }).join('\\n').substr(2);\n        } else {\n          str = '\\n' + str.split('\\n').map(function(line) {\n            return '   ' + line;\n          }).join('\\n');\n        }\n      }\n    } else {\n      str = ctx.stylize('[Circular]', 'special');\n    }\n  }\n  if (isUndefined(name)) {\n    if (array && key.match(/^\\d+$/)) {\n      return str;\n    }\n    name = JSON.stringify('' + key);\n    if (name.match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)) {\n      name = name.substr(1, name.length - 2);\n      name = ctx.stylize(name, 'name');\n    } else {\n      name = name.replace(/'/g, \"\\\\'\")\n                 .replace(/\\\\\"/g, '\"')\n                 .replace(/(^\"|\"$)/g, \"'\");\n      name = ctx.stylize(name, 'string');\n    }\n  }\n\n  return name + ': ' + str;\n}\n\n\nfunction reduceToSingleString(output, base, braces) {\n  var numLinesEst = 0;\n  var length = output.reduce(function(prev, cur) {\n    numLinesEst++;\n    if (cur.indexOf('\\n') >= 0) numLinesEst++;\n    return prev + cur.replace(/\\u001b\\[\\d\\d?m/g, '').length + 1;\n  }, 0);\n\n  if (length > 60) {\n    return braces[0] +\n           (base === '' ? '' : base + '\\n ') +\n           ' ' +\n           output.join(',\\n  ') +\n           ' ' +\n           braces[1];\n  }\n\n  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];\n}\n\n\n// NOTE: These type checking functions intentionally don't use `instanceof`\n// because it is fragile and can be easily faked with `Object.create()`.\nfunction isArray(ar) {\n  return Array.isArray(ar);\n}\nexports.isArray = isArray;\n\nfunction isBoolean(arg) {\n  return typeof arg === 'boolean';\n}\nexports.isBoolean = isBoolean;\n\nfunction isNull(arg) {\n  return arg === null;\n}\nexports.isNull = isNull;\n\nfunction isNullOrUndefined(arg) {\n  return arg == null;\n}\nexports.isNullOrUndefined = isNullOrUndefined;\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\nexports.isNumber = isNumber;\n\nfunction isString(arg) {\n  return typeof arg === 'string';\n}\nexports.isString = isString;\n\nfunction isSymbol(arg) {\n  return typeof arg === 'symbol';\n}\nexports.isSymbol = isSymbol;\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\nexports.isUndefined = isUndefined;\n\nfunction isRegExp(re) {\n  return isObject(re) && objectToString(re) === '[object RegExp]';\n}\nexports.isRegExp = isRegExp;\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\nexports.isObject = isObject;\n\nfunction isDate(d) {\n  return isObject(d) && objectToString(d) === '[object Date]';\n}\nexports.isDate = isDate;\n\nfunction isError(e) {\n  return isObject(e) &&\n      (objectToString(e) === '[object Error]' || e instanceof Error);\n}\nexports.isError = isError;\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\nexports.isFunction = isFunction;\n\nfunction isPrimitive(arg) {\n  return arg === null ||\n         typeof arg === 'boolean' ||\n         typeof arg === 'number' ||\n         typeof arg === 'string' ||\n         typeof arg === 'symbol' ||  // ES6 symbol\n         typeof arg === 'undefined';\n}\nexports.isPrimitive = isPrimitive;\n\nexports.isBuffer = require('./support/isBuffer');\n\nfunction objectToString(o) {\n  return Object.prototype.toString.call(o);\n}\n\n\nfunction pad(n) {\n  return n < 10 ? '0' + n.toString(10) : n.toString(10);\n}\n\n\nvar months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',\n              'Oct', 'Nov', 'Dec'];\n\n// 26 Feb 16:19:34\nfunction timestamp() {\n  var d = new Date();\n  var time = [pad(d.getHours()),\n              pad(d.getMinutes()),\n              pad(d.getSeconds())].join(':');\n  return [d.getDate(), months[d.getMonth()], time].join(' ');\n}\n\n\n// log is just a thin wrapper to console.log that prepends a timestamp\nexports.log = function() {\n  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));\n};\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * The Function.prototype.inherits from lang.js rewritten as a standalone\n * function (not on Function.prototype). NOTE: If this file is to be loaded\n * during bootstrapping this function needs to be rewritten using some native\n * functions as prototype setup using normal JavaScript does not work as\n * expected during bootstrapping (see mirror.js in r114903).\n *\n * @param {function} ctor Constructor function which needs to inherit the\n *     prototype.\n * @param {function} superCtor Constructor function to inherit prototype from.\n */\nexports.inherits = require('inherits');\n\nexports._extend = function(origin, add) {\n  // Don't do anything if add isn't an object\n  if (!add || !isObject(add)) return origin;\n\n  var keys = Object.keys(add);\n  var i = keys.length;\n  while (i--) {\n    origin[keys[i]] = add[keys[i]];\n  }\n  return origin;\n};\n\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nvar kCustomPromisifiedSymbol = typeof Symbol !== 'undefined' ? Symbol('util.promisify.custom') : undefined;\n\nexports.promisify = function promisify(original) {\n  if (typeof original !== 'function')\n    throw new TypeError('The \"original\" argument must be of type Function');\n\n  if (kCustomPromisifiedSymbol && original[kCustomPromisifiedSymbol]) {\n    var fn = original[kCustomPromisifiedSymbol];\n    if (typeof fn !== 'function') {\n      throw new TypeError('The \"util.promisify.custom\" argument must be of type Function');\n    }\n    Object.defineProperty(fn, kCustomPromisifiedSymbol, {\n      value: fn, enumerable: false, writable: false, configurable: true\n    });\n    return fn;\n  }\n\n  function fn() {\n    var promiseResolve, promiseReject;\n    var promise = new Promise(function (resolve, reject) {\n      promiseResolve = resolve;\n      promiseReject = reject;\n    });\n\n    var args = [];\n    for (var i = 0; i < arguments.length; i++) {\n      args.push(arguments[i]);\n    }\n    args.push(function (err, value) {\n      if (err) {\n        promiseReject(err);\n      } else {\n        promiseResolve(value);\n      }\n    });\n\n    try {\n      original.apply(this, args);\n    } catch (err) {\n      promiseReject(err);\n    }\n\n    return promise;\n  }\n\n  Object.setPrototypeOf(fn, Object.getPrototypeOf(original));\n\n  if (kCustomPromisifiedSymbol) Object.defineProperty(fn, kCustomPromisifiedSymbol, {\n    value: fn, enumerable: false, writable: false, configurable: true\n  });\n  return Object.defineProperties(\n    fn,\n    getOwnPropertyDescriptors(original)\n  );\n}\n\nexports.promisify.custom = kCustomPromisifiedSymbol\n\nfunction callbackifyOnRejected(reason, cb) {\n  // `!reason` guard inspired by bluebird (Ref: https://goo.gl/t5IS6M).\n  // Because `null` is a special error value in callbacks which means \"no error\n  // occurred\", we error-wrap so the callback consumer can distinguish between\n  // \"the promise rejected with null\" or \"the promise fulfilled with undefined\".\n  if (!reason) {\n    var newReason = new Error('Promise was rejected with a falsy value');\n    newReason.reason = reason;\n    reason = newReason;\n  }\n  return cb(reason);\n}\n\nfunction callbackify(original) {\n  if (typeof original !== 'function') {\n    throw new TypeError('The \"original\" argument must be of type Function');\n  }\n\n  // We DO NOT return the promise as it gives the user a false sense that\n  // the promise is actually somehow related to the callback's execution\n  // and that the callback throwing will reject the promise.\n  function callbackified() {\n    var args = [];\n    for (var i = 0; i < arguments.length; i++) {\n      args.push(arguments[i]);\n    }\n\n    var maybeCb = args.pop();\n    if (typeof maybeCb !== 'function') {\n      throw new TypeError('The last argument must be of type Function');\n    }\n    var self = this;\n    var cb = function() {\n      return maybeCb.apply(self, arguments);\n    };\n    // In true node style we process the callback on `nextTick` with all the\n    // implications (stack, `uncaughtException`, `async_hooks`)\n    original.apply(this, args)\n      .then(function(ret) { process.nextTick(cb, null, ret) },\n            function(rej) { process.nextTick(callbackifyOnRejected, rej, cb) });\n  }\n\n  Object.setPrototypeOf(callbackified, Object.getPrototypeOf(original));\n  Object.defineProperties(callbackified,\n                          getOwnPropertyDescriptors(original));\n  return callbackified;\n}\nexports.callbackify = callbackify;\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\nmodule.exports.once = once;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n\nfunction once(emitter, name) {\n  return new Promise(function (resolve, reject) {\n    function errorListener(err) {\n      emitter.removeListener(name, resolver);\n      reject(err);\n    }\n\n    function resolver() {\n      if (typeof emitter.removeListener === 'function') {\n        emitter.removeListener('error', errorListener);\n      }\n      resolve([].slice.call(arguments));\n    };\n\n    eventTargetAgnosticAddListener(emitter, name, resolver, { once: true });\n    if (name !== 'error') {\n      addErrorHandlerIfEventEmitter(emitter, errorListener, { once: true });\n    }\n  });\n}\n\nfunction addErrorHandlerIfEventEmitter(emitter, handler, flags) {\n  if (typeof emitter.on === 'function') {\n    eventTargetAgnosticAddListener(emitter, 'error', handler, flags);\n  }\n}\n\nfunction eventTargetAgnosticAddListener(emitter, name, listener, flags) {\n  if (typeof emitter.on === 'function') {\n    if (flags.once) {\n      emitter.once(name, listener);\n    } else {\n      emitter.on(name, listener);\n    }\n  } else if (typeof emitter.addEventListener === 'function') {\n    // EventTarget does not have `error` event semantics like Node\n    // EventEmitters, we do not listen for `error` events here.\n    emitter.addEventListener(name, function wrapListener(arg) {\n      // IE does not have builtin `{ once: true }` support so we\n      // have to do it manually.\n      if (flags.once) {\n        emitter.removeEventListener(name, wrapListener);\n      }\n      listener(arg);\n    });\n  } else {\n    throw new TypeError('The \"emitter\" argument must be of type EventEmitter. Received type ' + typeof emitter);\n  }\n}\n","'use strict';\n\nmodule.exports = exports = require('./lib/circuit');\n","'use strict';\n\nconst EventEmitter = require('events');\nconst Status = require('./status');\nconst Semaphore = require('./semaphore');\n\nconst STATE = Symbol('state');\nconst OPEN = Symbol('open');\nconst CLOSED = Symbol('closed');\nconst HALF_OPEN = Symbol('half-open');\nconst PENDING_CLOSE = Symbol('pending-close');\nconst SHUTDOWN = Symbol('shutdown');\nconst FALLBACK_FUNCTION = Symbol('fallback');\nconst STATUS = Symbol('status');\nconst NAME = Symbol('name');\nconst GROUP = Symbol('group');\nconst CACHE = new WeakMap();\nconst ENABLED = Symbol('Enabled');\nconst WARMING_UP = Symbol('warming-up');\nconst VOLUME_THRESHOLD = Symbol('volume-threshold');\nconst OUR_ERROR = Symbol('our-error');\nconst RESET_TIMEOUT = Symbol('reset-timeout');\nconst WARMUP_TIMEOUT = Symbol('warmup-timeout');\nconst deprecation = `options.maxFailures is deprecated. \\\nPlease use options.errorThresholdPercentage`;\n\n/**\n * Constructs a {@link CircuitBreaker}.\n *\n * @class CircuitBreaker\n * @extends EventEmitter\n * @param {Function} action The action to fire for this {@link CircuitBreaker}\n * @param {Object} options Options for the {@link CircuitBreaker}\n * @param {Status} options.status A {@link Status} object that might\n *   have pre-prime stats\n * @param {Number} options.timeout The time in milliseconds that action should\n * be allowed to execute before timing out. Timeout can be disabled by setting\n * this to `false`. Default 10000 (10 seconds)\n * @param {Number} options.maxFailures (Deprecated) The number of times the\n * circuit can fail before opening. Default 10.\n * @param {Number} options.resetTimeout The time in milliseconds to wait before\n * setting the breaker to `halfOpen` state, and trying the action again.\n * Default: 30000 (30 seconds)\n * @param {Number} options.rollingCountTimeout Sets the duration of the\n * statistical rolling window, in milliseconds. This is how long Opossum keeps\n * metrics for the circuit breaker to use and for publishing. Default: 10000\n * @param {Number} options.rollingCountBuckets Sets the number of buckets the\n * rolling statistical window is divided into. So, if\n * options.rollingCountTimeout is 10000, and options.rollingCountBuckets is 10,\n * then the statistical window will be 1000/1 second snapshots in the\n * statistical window. Default: 10\n * @param {String} options.name the circuit name to use when reporting stats.\n * Default: the name of the function this circuit controls.\n * @param {boolean} options.rollingPercentilesEnabled This property indicates\n * whether execution latencies should be tracked and calculated as percentiles.\n * If they are disabled, all summary statistics (mean, percentiles) are\n * returned as -1. Default: true\n * @param {Number} options.capacity the number of concurrent requests allowed.\n * If the number currently executing function calls is equal to\n * options.capacity, further calls to `fire()` are rejected until at least one\n * of the current requests completes. Default: `Number.MAX_SAFE_INTEGER`.\n * @param {Number} options.errorThresholdPercentage the error percentage at\n * which to open the circuit and start short-circuiting requests to fallback.\n * Default: 50\n * @param {boolean} options.enabled whether this circuit is enabled upon\n * construction. Default: true\n * @param {boolean} options.allowWarmUp determines whether to allow failures\n * without opening the circuit during a brief warmup period (this is the\n * `rollingCountTimeout` property). Default: false\n * This can help in situations where no matter what your\n * `errorThresholdPercentage` is, if the first execution times out or fails,\n * the circuit immediately opens.\n * @param {Number} options.volumeThreshold the minimum number of requests within\n * the rolling statistical window that must exist before the circuit breaker\n * can open. This is similar to `options.allowWarmUp` in that no matter how many\n * failures there are, if the number of requests within the statistical window\n * does not exceed this threshold, the circuit will remain closed. Default: 0\n * @param {Function} options.errorFilter an optional function that will be\n * called when the circuit's function fails (returns a rejected Promise). If\n * this function returns truthy, the circuit's failPure statistics will not be\n * incremented. This is useful, for example, when you don't want HTTP 404 to\n * trip the circuit, but still want to handle it as a failure case.\n * @param {boolean} options.cache whether the return value of the first\n * successful execution of the circuit's function will be cached. Once a value\n * has been cached that value will be returned for every subsequent execution:\n * the cache can be cleared using `clearCache`. (The metrics `cacheHit` and\n * `cacheMiss` reflect cache activity.) Default: false\n *\n *\n * @fires CircuitBreaker#halfOpen\n * @fires CircuitBreaker#close\n * @fires CircuitBreaker#open\n * @fires CircuitBreaker#fire\n * @fires CircuitBreaker#cacheHit\n * @fires CircuitBreaker#cacheMiss\n * @fires CircuitBreaker#reject\n * @fires CircuitBreaker#timeout\n * @fires CircuitBreaker#success\n * @fires CircuitBreaker#semaphoreLocked\n * @fires CircuitBreaker#healthCheckFailed\n * @fires CircuitBreaker#fallback\n * @fires CircuitBreaker#failure\n */\nclass CircuitBreaker extends EventEmitter {\n  /**\n   * Returns true if the provided error was generated here. It will be false\n   * if the error came from the action itself.\n   * @param {Error} error The Error to check.\n   * @returns {Boolean} true if the error was generated here\n   */\n  static isOurError (error) {\n    return !!error[OUR_ERROR];\n  }\n\n  /**\n  * Create a new Status object,\n  * helpful when you need to prime a breaker with stats\n  * @param {Object} options -\n  * @param {Number} options.rollingCountBuckets number of buckets in the window\n  * @param {Number} options.rollingCountTimeout the duration of the window\n  * @param {Boolean} options.rollingPercentilesEnabled whether to calculate\n  * @param {Object} options.stats user supplied stats\n  * @returns {Status} a new {@link Status} object\n  */\n  static newStatus (options) {\n    return new Status(options);\n  }\n\n  constructor (action, options = {}) {\n    super();\n    this.options = options;\n    this.options.timeout =\n      options.timeout === false ? false : options.timeout || 10000;\n    this.options.resetTimeout = options.resetTimeout || 30000;\n    this.options.errorThresholdPercentage =\n      options.errorThresholdPercentage || 50;\n    this.options.rollingCountTimeout = options.rollingCountTimeout || 10000;\n    this.options.rollingCountBuckets = options.rollingCountBuckets || 10;\n    this.options.rollingPercentilesEnabled =\n      options.rollingPercentilesEnabled !== false;\n    this.options.capacity = Number.isInteger(options.capacity)\n      ? options.capacity\n      : Number.MAX_SAFE_INTEGER;\n    this.options.errorFilter = options.errorFilter || (_ => false);\n\n    this.semaphore = new Semaphore(this.options.capacity);\n\n    // check if action is defined\n    if (!action) {\n      throw new TypeError(\n        'No action provided. Cannot construct a CircuitBreaker without an invocable action.'\n      );\n    }\n\n    this[VOLUME_THRESHOLD] = Number.isInteger(options.volumeThreshold)\n      ? options.volumeThreshold\n      : 0;\n    this[WARMING_UP] = options.allowWarmUp === true;\n\n    // The user can pass in a Status object to initialize the Status/stats\n    if (this.options.status) {\n      // Do a check that this is a Status Object,\n      if (this.options.status instanceof Status) {\n        this[STATUS] = this.options.status;\n      } else {\n        this[STATUS] = new Status({ stats: this.options.status });\n      }\n    } else {\n      this[STATUS] = new Status(this.options);\n    }\n\n    this[STATE] = CLOSED;\n\n    if (options.state) {\n      this[ENABLED] = options.state.enabled !== false;\n      this[WARMING_UP] = options.state.warmUp || this[WARMING_UP];\n      // Closed if nothing is passed in\n      this[CLOSED] = options.state.closed !== false;\n      // These should be in sync\n      this[HALF_OPEN] = this[PENDING_CLOSE] = options.state.halfOpen || false;\n      // Open should be the opposite of closed,\n      // but also the opposite of half_open\n      this[OPEN] = !this[CLOSED] && !this[HALF_OPEN];\n\n      this[SHUTDOWN] = options.state.shutdown || false;\n    } else {\n      this[PENDING_CLOSE] = false;\n      this[ENABLED] = options.enabled !== false;\n    }\n\n    this[FALLBACK_FUNCTION] = null;\n    this[NAME] = options.name || action.name || nextName();\n    this[GROUP] = options.group || this[NAME];\n\n    if (this[WARMING_UP]) {\n      const timer = this[WARMUP_TIMEOUT] = setTimeout(\n        _ => (this[WARMING_UP] = false),\n        this.options.rollingCountTimeout\n      );\n      if (typeof timer.unref === 'function') {\n        timer.unref();\n      }\n    }\n\n    if (typeof action !== 'function') {\n      this.action = _ => Promise.resolve(action);\n    } else this.action = action;\n\n    if (options.maxFailures) console.error(deprecation);\n\n    const increment = property =>\n      (result, runTime) => this[STATUS].increment(property, runTime);\n\n    this.on('success', increment('successes'));\n    this.on('failure', increment('failures'));\n    this.on('fallback', increment('fallbacks'));\n    this.on('timeout', increment('timeouts'));\n    this.on('fire', increment('fires'));\n    this.on('reject', increment('rejects'));\n    this.on('cacheHit', increment('cacheHits'));\n    this.on('cacheMiss', increment('cacheMisses'));\n    this.on('open', _ => this[STATUS].open());\n    this.on('close', _ => this[STATUS].close());\n    this.on('semaphoreLocked', increment('semaphoreRejections'));\n\n    /**\n     * @param {CircuitBreaker} circuit This current circuit\n     * @returns {function(): void} A bound reset callback\n     * @private\n     */\n    function _startTimer (circuit) {\n      return _ => {\n        const timer = circuit[RESET_TIMEOUT] = setTimeout(() => {\n          circuit[STATE] = HALF_OPEN;\n          circuit[PENDING_CLOSE] = true;\n          /**\n           * Emitted after `options.resetTimeout` has elapsed, allowing for\n           * a single attempt to call the service again. If that attempt is\n           * successful, the circuit will be closed. Otherwise it remains open.\n           *\n           * @event CircuitBreaker#halfOpen\n           * @type {Number} how long the circuit remained open\n           */\n          circuit.emit('halfOpen', circuit.options.resetTimeout);\n        }, circuit.options.resetTimeout);\n        if (typeof timer.unref === 'function') {\n          timer.unref();\n        }\n      };\n    }\n\n    this.on('open', _startTimer(this));\n    this.on('success', _ => {\n      if (this.halfOpen) {\n        this.close();\n      }\n    });\n    if (this.options.cache) {\n      CACHE.set(this, undefined);\n    }\n\n    // Prepopulate the State of the Breaker\n    if (this[SHUTDOWN]) {\n      this[STATE] = SHUTDOWN;\n      this.shutdown();\n    } else if (this[CLOSED]) {\n      this.close();\n    } else if (this[OPEN]) {\n      // If the state being passed in is OPEN\n      // THen we need to start some timers\n      this.open();\n    } else if (this[HALF_OPEN]) {\n      // Not sure if anythign needs to be done here\n      this[STATE] = HALF_OPEN;\n    }\n  }\n\n  /**\n   * Closes the breaker, allowing the action to execute again\n   * @fires CircuitBreaker#close\n   * @returns {void}\n   */\n  close () {\n    if (this[STATE] !== CLOSED) {\n      if (this[RESET_TIMEOUT]) {\n        clearTimeout(this[RESET_TIMEOUT]);\n      }\n      this[STATE] = CLOSED;\n      this[PENDING_CLOSE] = false;\n      /**\n       * Emitted when the breaker is reset allowing the action to execute again\n       * @event CircuitBreaker#close\n       */\n      this.emit('close');\n    }\n  }\n\n  /**\n   * Opens the breaker. Each time the breaker is fired while the circuit is\n   * opened, a failed Promise is returned, or if any fallback function\n   * has been provided, it is invoked.\n   *\n   * If the breaker is already open this call does nothing.\n   * @fires CircuitBreaker#open\n   * @returns {void}\n   */\n  open () {\n    if (this[STATE] !== OPEN) {\n      this[STATE] = OPEN;\n      this[PENDING_CLOSE] = false;\n      /**\n       * Emitted when the breaker opens because the action has\n       * failed more than `options.maxFailures` number of times.\n       * @event CircuitBreaker#open\n       */\n      this.emit('open');\n    }\n  }\n\n  /**\n   * Shuts down this circuit breaker. All subsequent calls to the\n   * circuit will fail, returning a rejected promise.\n   * @returns {void}\n   */\n  shutdown () {\n    /**\n     * Emitted when the circuit breaker has been shut down.\n     * @event CircuitBreaker#shutdown\n     */\n    this.emit('shutdown');\n\n    this.disable();\n    this.removeAllListeners();\n    if (this[RESET_TIMEOUT]) {\n      clearTimeout(this[RESET_TIMEOUT]);\n    }\n    if (this[WARMUP_TIMEOUT]) {\n      clearTimeout(this[WARMUP_TIMEOUT]);\n    }\n    this.status.shutdown();\n    this[STATE] = SHUTDOWN;\n  }\n\n  /**\n   * Determines if the circuit has been shutdown.\n   * @type {Boolean}\n   */\n  get isShutdown () {\n    return this[STATE] === SHUTDOWN;\n  }\n\n  /**\n   * Gets the name of this circuit\n   * @type {String}\n   */\n  get name () {\n    return this[NAME];\n  }\n\n  /**\n   * Gets the name of this circuit group\n   * @type {String}\n   */\n  get group () {\n    return this[GROUP];\n  }\n\n  /**\n   * Gets whether this circuit is in the `pendingClosed` state\n   * @type {Boolean}\n   */\n  get pendingClose () {\n    return this[PENDING_CLOSE];\n  }\n\n  /**\n   * True if the circuit is currently closed. False otherwise.\n   * @type {Boolean}\n   */\n  get closed () {\n    return this[STATE] === CLOSED;\n  }\n\n  /**\n   * True if the circuit is currently opened. False otherwise.\n   * @type {Boolean}\n   */\n  get opened () {\n    return this[STATE] === OPEN;\n  }\n\n  /**\n   * True if the circuit is currently half opened. False otherwise.\n   * @type {Boolean}\n   */\n  get halfOpen () {\n    return this[STATE] === HALF_OPEN;\n  }\n\n  /**\n   * The current {@link Status} of this {@link CircuitBreaker}\n   * @type {Status}\n   */\n  get status () {\n    return this[STATUS];\n  }\n\n  /**\n   * Get the current stats for the circuit.\n   * @see Status#stats\n   * @type {Object}\n   */\n  get stats () {\n    return this[STATUS].stats;\n  }\n\n  toJSON () {\n    return {\n      state: {\n        name: this.name,\n        enabled: this.enabled,\n        closed: this.closed,\n        open: this.opened,\n        halfOpen: this.halfOpen,\n        warmUp: this.warmUp,\n        shutdown: this.isShutdown\n      },\n      status: this.status.stats\n    };\n  }\n\n  /**\n   * Gets whether the circuit is enabled or not\n   * @type {Boolean}\n   */\n  get enabled () {\n    return this[ENABLED];\n  }\n\n  /**\n   * Gets whether the circuit is currently in warm up phase\n   * @type {Boolean}\n   */\n  get warmUp () {\n    return this[WARMING_UP];\n  }\n\n  /**\n   * Gets the volume threshold for this circuit\n   * @type {Boolean}\n   */\n  get volumeThreshold () {\n    return this[VOLUME_THRESHOLD];\n  }\n\n  /**\n   * Provide a fallback function for this {@link CircuitBreaker}. This\n   * function will be executed when the circuit is `fire`d and fails.\n   * It will always be preceded by a `failure` event, and `breaker.fire` returns\n   * a rejected Promise.\n   * @param {Function | CircuitBreaker} func the fallback function to execute\n   * when the breaker has opened or when a timeout or error occurs.\n   * @return {CircuitBreaker} this\n   */\n  fallback (func) {\n    let fb = func;\n    if (func instanceof CircuitBreaker) {\n      fb = function () {\n        return func.fire.apply(func, arguments);\n      };\n    }\n    this[FALLBACK_FUNCTION] = fb;\n    return this;\n  }\n\n  /**\n   * Execute the action for this circuit. If the action fails or times out, the\n   * returned promise will be rejected. If the action succeeds, the promise will\n   * resolve with the resolved value from action. If a fallback function was\n   * provided, it will be invoked in the event of any failure or timeout.\n   *\n   * Any parameters passed to this function will be proxied to the circuit\n   * function.\n   *\n   * @return {Promise<any>} promise resolves with the circuit function's return\n   * value on success or is rejected on failure of the action. Use isOurError()\n   * to determine if a rejection was a result of the circuit breaker or the\n   * action.\n   *\n   * @fires CircuitBreaker#failure\n   * @fires CircuitBreaker#fallback\n   * @fires CircuitBreaker#fire\n   * @fires CircuitBreaker#reject\n   * @fires CircuitBreaker#success\n   * @fires CircuitBreaker#timeout\n   * @fires CircuitBreaker#semaphoreLocked\n   */\n  fire (...args) {\n    return this.call.apply(this, [this.action].concat(args));\n  }\n\n  /**\n   * Execute the action for this circuit using `context` as `this`.\n   * If the action fails or times out, the\n   * returned promise will be rejected. If the action succeeds, the promise will\n   * resolve with the resolved value from action. If a fallback function was\n   * provided, it will be invoked in the event of any failure or timeout.\n   *\n   * Any parameters in addition to `context will be passed to the\n   * circuit function.\n   *\n   * @param {any} context the `this` context used for function execution\n   * @param {any} rest the arguments passed to the action\n   *\n   * @return {Promise<any>} promise resolves with the circuit function's return\n   * value on success or is rejected on failure of the action.\n   *\n   * @fires CircuitBreaker#failure\n   * @fires CircuitBreaker#fallback\n   * @fires CircuitBreaker#fire\n   * @fires CircuitBreaker#reject\n   * @fires CircuitBreaker#success\n   * @fires CircuitBreaker#timeout\n   * @fires CircuitBreaker#semaphoreLocked\n   */\n  call (context, ...rest) {\n    if (this.isShutdown) {\n      const err = buildError('The circuit has been shutdown.', 'ESHUTDOWN');\n      return Promise.reject(err);\n    }\n    const args = Array.prototype.slice.call(rest);\n\n    /**\n     * Emitted when the circuit breaker action is executed\n     * @event CircuitBreaker#fire\n     * @type {any} the arguments passed to the fired function\n     */\n    this.emit('fire', args);\n\n    if (CACHE.get(this) !== undefined) {\n      /**\n       * Emitted when the circuit breaker is using the cache\n       * and finds a value.\n       * @event CircuitBreaker#cacheHit\n       */\n      this.emit('cacheHit');\n      return CACHE.get(this);\n    } else if (this.options.cache) {\n      /**\n       * Emitted when the circuit breaker does not find a value in\n       * the cache, but the cache option is enabled.\n       * @event CircuitBreaker#cacheMiss\n       */\n      this.emit('cacheMiss');\n    }\n\n    if (!this[ENABLED]) {\n      const result = this.action.apply(context, args);\n      return (typeof result.then === 'function')\n        ? result\n        : Promise.resolve(result);\n    }\n\n    if (!this.closed && !this.pendingClose) {\n      /**\n       * Emitted when the circuit breaker is open and failing fast\n       * @event CircuitBreaker#reject\n       * @type {Error}\n       */\n      const error = buildError('Breaker is open', 'EOPENBREAKER');\n\n      this.emit('reject', error);\n\n      return fallback(this, error, args) ||\n        Promise.reject(error);\n    }\n    this[PENDING_CLOSE] = false;\n\n    let timeout;\n    let timeoutError = false;\n    return new Promise((resolve, reject) => {\n      const latencyStartTime = Date.now();\n      if (this.semaphore.test()) {\n        if (this.options.timeout) {\n          timeout = setTimeout(\n            () => {\n              timeoutError = true;\n              const error = buildError(\n                `Timed out after ${this.options.timeout}ms`, 'ETIMEDOUT'\n              );\n              const latency = Date.now() - latencyStartTime;\n              this.semaphore.release();\n              /**\n               * Emitted when the circuit breaker action takes longer than\n               * `options.timeout`\n               * @event CircuitBreaker#timeout\n               * @type {Error}\n               */\n              this.emit('timeout', error, latency, args);\n              handleError(error, this, timeout, args, latency, resolve, reject);\n            }, this.options.timeout);\n        }\n\n        try {\n          const result = this.action.apply(context, args);\n          const promise = (typeof result.then === 'function')\n            ? result\n            : Promise.resolve(result);\n\n          promise.then(result => {\n            if (!timeoutError) {\n              clearTimeout(timeout);\n              /**\n               * Emitted when the circuit breaker action succeeds\n               * @event CircuitBreaker#success\n               * @type {any} the return value from the circuit\n               */\n              this.emit('success', result, (Date.now() - latencyStartTime));\n              this.semaphore.release();\n              resolve(result);\n              if (this.options.cache) {\n                CACHE.set(this, promise);\n              }\n            }\n          })\n            .catch(error => {\n              if (!timeoutError) {\n                this.semaphore.release();\n                const latencyEndTime = Date.now() - latencyStartTime;\n                handleError(\n                  error, this, timeout, args, latencyEndTime, resolve, reject);\n              }\n            });\n        } catch (error) {\n          this.semaphore.release();\n          const latency = Date.now() - latencyStartTime;\n          handleError(error, this, timeout, args, latency, resolve, reject);\n        }\n      } else {\n        const latency = Date.now() - latencyStartTime;\n        const err = buildError('Semaphore locked', 'ESEMLOCKED');\n        /**\n         * Emitted when the rate limit has been reached and there\n         * are no more locks to be obtained.\n         * @event CircuitBreaker#semaphoreLocked\n         * @type {Error}\n         */\n        this.emit('semaphoreLocked', err, latency);\n        handleError(err, this, timeout, args, latency, resolve, reject);\n      }\n    });\n  }\n\n  /**\n   * Clears the cache of this {@link CircuitBreaker}\n   * @returns {void}\n   */\n  clearCache () {\n    CACHE.set(this, undefined);\n  }\n\n  /**\n   * Provide a health check function to be called periodically. The function\n   * should return a Promise. If the promise is rejected the circuit will open.\n   * This is in addition to the existing circuit behavior as defined by\n   * `options.errorThresholdPercentage` in the constructor. For example, if the\n   * health check function provided here always returns a resolved promise, the\n   * circuit can still trip and open if there are failures exceeding the\n   * configured threshold. The health check function is executed within the\n   * circuit breaker's execution context, so `this` within the function is the\n   * circuit breaker itself.\n   *\n   * @param {Function} func a health check function which returns a promise.\n   * @param {Number} [interval] the amount of time between calls to the health\n   * check function. Default: 5000 (5 seconds)\n   *\n   * @returns {void}\n   *\n   * @fires CircuitBreaker#healthCheckFailed\n   * @throws {TypeError} if `interval` is supplied but not a number\n   */\n  healthCheck (func, interval) {\n    interval = interval || 5000;\n    if (typeof func !== 'function') {\n      throw new TypeError('Health check function must be a function');\n    }\n    if (isNaN(interval)) {\n      throw new TypeError('Health check interval must be a number');\n    }\n\n    const check = _ => {\n      func.apply(this).catch(e => {\n        /**\n         * Emitted with the user-supplied health check function\n         * returns a rejected promise.\n         * @event CircuitBreaker#healthCheckFailed\n         * @type {Error}\n         */\n        this.emit('healthCheckFailed', e);\n        this.open();\n      });\n    };\n\n    const timer = setInterval(check, interval);\n    if (typeof timer.unref === 'function') {\n      timer.unref();\n    }\n\n    check();\n  }\n\n  /**\n   * Enables this circuit. If the circuit is the  disabled\n   * state, it will be re-enabled. If not, this is essentially\n   * a noop.\n   * @returns {void}\n   */\n  enable () {\n    this[ENABLED] = true;\n  }\n\n  /**\n   * Disables this circuit, causing all calls to the circuit's function\n   * to be executed without circuit or fallback protection.\n   * @returns {void}\n   */\n  disable () {\n    this[ENABLED] = false;\n  }\n}\n\nfunction handleError (error, circuit, timeout, args, latency, resolve, reject) {\n  clearTimeout(timeout);\n\n  if (circuit.options.errorFilter(error, ...args)) {\n    // The error was filtered, so emit 'success'\n    circuit.emit('success', error, latency);\n  } else {\n    // Error was not filtered, so emit 'failure'\n    fail(circuit, error, args, latency);\n\n    // Only call the fallback function if errorFilter doesn't succeed\n    // If the fallback function succeeds, resolve\n    const fb = fallback(circuit, error, args);\n    if (fb) return resolve(fb);\n  }\n  // In all other cases, reject\n  reject(error);\n}\n\nfunction fallback (circuit, err, args) {\n  if (circuit[FALLBACK_FUNCTION]) {\n    try {\n      const result =\n      circuit[FALLBACK_FUNCTION]\n        .apply(circuit[FALLBACK_FUNCTION], [...args, err]);\n      /**\n       * Emitted when the circuit breaker executes a fallback function\n       * @event CircuitBreaker#fallback\n       * @type {any} the return value of the fallback function\n       */\n      circuit.emit('fallback', result, err);\n      if (result instanceof Promise) return result;\n      return Promise.resolve(result);\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  }\n}\n\nfunction fail (circuit, err, args, latency) {\n  /**\n   * Emitted when the circuit breaker action fails\n   * @event CircuitBreaker#failure\n   * @type {Error}\n   */\n  circuit.emit('failure', err, latency, args);\n  if (circuit.warmUp) return;\n\n  // check stats to see if the circuit should be opened\n  const stats = circuit.stats;\n  if ((stats.fires < circuit.volumeThreshold) && !circuit.halfOpen) return;\n  const errorRate = stats.failures / stats.fires * 100;\n  if (errorRate > circuit.options.errorThresholdPercentage ||\n    stats.failures >= circuit.options.maxFailures ||\n    circuit.halfOpen) {\n    circuit.open();\n  }\n}\n\nfunction buildError (msg, code) {\n  const error = new Error(msg);\n  error.code = code;\n  error[OUR_ERROR] = true;\n  return error;\n}\n\n// http://stackoverflow.com/a/2117523\nconst nextName = () =>\n  'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c => {\n    const r = Math.random() * 16 | 0;\n    const v = c === 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n\nmodule.exports = exports = CircuitBreaker;\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","module.exports = function isBuffer(arg) {\n  return arg && typeof arg === 'object'\n    && typeof arg.copy === 'function'\n    && typeof arg.fill === 'function'\n    && typeof arg.readUInt8 === 'function';\n}","if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    var TempCtor = function () {}\n    TempCtor.prototype = superCtor.prototype\n    ctor.prototype = new TempCtor()\n    ctor.prototype.constructor = ctor\n  }\n}\n","'use strict';\n\nvar objectAssign = require('object-assign');\n\n// compare and isBuffer taken from https://github.com/feross/buffer/blob/680e9e5e488f22aac27599a57dc844a6315928dd/index.js\n// original notice:\n\n/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>\n * @license  MIT\n */\nfunction compare(a, b) {\n  if (a === b) {\n    return 0;\n  }\n\n  var x = a.length;\n  var y = b.length;\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i];\n      y = b[i];\n      break;\n    }\n  }\n\n  if (x < y) {\n    return -1;\n  }\n  if (y < x) {\n    return 1;\n  }\n  return 0;\n}\nfunction isBuffer(b) {\n  if (global.Buffer && typeof global.Buffer.isBuffer === 'function') {\n    return global.Buffer.isBuffer(b);\n  }\n  return !!(b != null && b._isBuffer);\n}\n\n// based on node assert, original notice:\n// NB: The URL to the CommonJS spec is kept just for tradition.\n//     node-assert has evolved a lot since then, both in API and behavior.\n\n// http://wiki.commonjs.org/wiki/Unit_Testing/1.0\n//\n// THIS IS NOT TESTED NOR LIKELY TO WORK OUTSIDE V8!\n//\n// Originally from narwhal.js (http://narwhaljs.org)\n// Copyright (c) 2009 Thomas Robinson <280north.com>\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the 'Software'), to\n// deal in the Software without restriction, including without limitation the\n// rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\n// sell copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN\n// ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\n// WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar util = require('util/');\nvar hasOwn = Object.prototype.hasOwnProperty;\nvar pSlice = Array.prototype.slice;\nvar functionsHaveNames = (function () {\n  return function foo() {}.name === 'foo';\n}());\nfunction pToString (obj) {\n  return Object.prototype.toString.call(obj);\n}\nfunction isView(arrbuf) {\n  if (isBuffer(arrbuf)) {\n    return false;\n  }\n  if (typeof global.ArrayBuffer !== 'function') {\n    return false;\n  }\n  if (typeof ArrayBuffer.isView === 'function') {\n    return ArrayBuffer.isView(arrbuf);\n  }\n  if (!arrbuf) {\n    return false;\n  }\n  if (arrbuf instanceof DataView) {\n    return true;\n  }\n  if (arrbuf.buffer && arrbuf.buffer instanceof ArrayBuffer) {\n    return true;\n  }\n  return false;\n}\n// 1. The assert module provides functions that throw\n// AssertionError's when particular conditions are not met. The\n// assert module must conform to the following interface.\n\nvar assert = module.exports = ok;\n\n// 2. The AssertionError is defined in assert.\n// new assert.AssertionError({ message: message,\n//                             actual: actual,\n//                             expected: expected })\n\nvar regex = /\\s*function\\s+([^\\(\\s]*)\\s*/;\n// based on https://github.com/ljharb/function.prototype.name/blob/adeeeec8bfcc6068b187d7d9fb3d5bb1d3a30899/implementation.js\nfunction getName(func) {\n  if (!util.isFunction(func)) {\n    return;\n  }\n  if (functionsHaveNames) {\n    return func.name;\n  }\n  var str = func.toString();\n  var match = str.match(regex);\n  return match && match[1];\n}\nassert.AssertionError = function AssertionError(options) {\n  this.name = 'AssertionError';\n  this.actual = options.actual;\n  this.expected = options.expected;\n  this.operator = options.operator;\n  if (options.message) {\n    this.message = options.message;\n    this.generatedMessage = false;\n  } else {\n    this.message = getMessage(this);\n    this.generatedMessage = true;\n  }\n  var stackStartFunction = options.stackStartFunction || fail;\n  if (Error.captureStackTrace) {\n    Error.captureStackTrace(this, stackStartFunction);\n  } else {\n    // non v8 browsers so we can have a stacktrace\n    var err = new Error();\n    if (err.stack) {\n      var out = err.stack;\n\n      // try to strip useless frames\n      var fn_name = getName(stackStartFunction);\n      var idx = out.indexOf('\\n' + fn_name);\n      if (idx >= 0) {\n        // once we have located the function frame\n        // we need to strip out everything before it (and its line)\n        var next_line = out.indexOf('\\n', idx + 1);\n        out = out.substring(next_line + 1);\n      }\n\n      this.stack = out;\n    }\n  }\n};\n\n// assert.AssertionError instanceof Error\nutil.inherits(assert.AssertionError, Error);\n\nfunction truncate(s, n) {\n  if (typeof s === 'string') {\n    return s.length < n ? s : s.slice(0, n);\n  } else {\n    return s;\n  }\n}\nfunction inspect(something) {\n  if (functionsHaveNames || !util.isFunction(something)) {\n    return util.inspect(something);\n  }\n  var rawname = getName(something);\n  var name = rawname ? ': ' + rawname : '';\n  return '[Function' +  name + ']';\n}\nfunction getMessage(self) {\n  return truncate(inspect(self.actual), 128) + ' ' +\n         self.operator + ' ' +\n         truncate(inspect(self.expected), 128);\n}\n\n// At present only the three keys mentioned above are used and\n// understood by the spec. Implementations or sub modules can pass\n// other keys to the AssertionError's constructor - they will be\n// ignored.\n\n// 3. All of the following functions must throw an AssertionError\n// when a corresponding condition is not met, with a message that\n// may be undefined if not provided.  All assertion methods provide\n// both the actual and expected values to the assertion error for\n// display purposes.\n\nfunction fail(actual, expected, message, operator, stackStartFunction) {\n  throw new assert.AssertionError({\n    message: message,\n    actual: actual,\n    expected: expected,\n    operator: operator,\n    stackStartFunction: stackStartFunction\n  });\n}\n\n// EXTENSION! allows for well behaved errors defined elsewhere.\nassert.fail = fail;\n\n// 4. Pure assertion tests whether a value is truthy, as determined\n// by !!guard.\n// assert.ok(guard, message_opt);\n// This statement is equivalent to assert.equal(true, !!guard,\n// message_opt);. To test strictly for the value true, use\n// assert.strictEqual(true, guard, message_opt);.\n\nfunction ok(value, message) {\n  if (!value) fail(value, true, message, '==', assert.ok);\n}\nassert.ok = ok;\n\n// 5. The equality assertion tests shallow, coercive equality with\n// ==.\n// assert.equal(actual, expected, message_opt);\n\nassert.equal = function equal(actual, expected, message) {\n  if (actual != expected) fail(actual, expected, message, '==', assert.equal);\n};\n\n// 6. The non-equality assertion tests for whether two objects are not equal\n// with != assert.notEqual(actual, expected, message_opt);\n\nassert.notEqual = function notEqual(actual, expected, message) {\n  if (actual == expected) {\n    fail(actual, expected, message, '!=', assert.notEqual);\n  }\n};\n\n// 7. The equivalence assertion tests a deep equality relation.\n// assert.deepEqual(actual, expected, message_opt);\n\nassert.deepEqual = function deepEqual(actual, expected, message) {\n  if (!_deepEqual(actual, expected, false)) {\n    fail(actual, expected, message, 'deepEqual', assert.deepEqual);\n  }\n};\n\nassert.deepStrictEqual = function deepStrictEqual(actual, expected, message) {\n  if (!_deepEqual(actual, expected, true)) {\n    fail(actual, expected, message, 'deepStrictEqual', assert.deepStrictEqual);\n  }\n};\n\nfunction _deepEqual(actual, expected, strict, memos) {\n  // 7.1. All identical values are equivalent, as determined by ===.\n  if (actual === expected) {\n    return true;\n  } else if (isBuffer(actual) && isBuffer(expected)) {\n    return compare(actual, expected) === 0;\n\n  // 7.2. If the expected value is a Date object, the actual value is\n  // equivalent if it is also a Date object that refers to the same time.\n  } else if (util.isDate(actual) && util.isDate(expected)) {\n    return actual.getTime() === expected.getTime();\n\n  // 7.3 If the expected value is a RegExp object, the actual value is\n  // equivalent if it is also a RegExp object with the same source and\n  // properties (`global`, `multiline`, `lastIndex`, `ignoreCase`).\n  } else if (util.isRegExp(actual) && util.isRegExp(expected)) {\n    return actual.source === expected.source &&\n           actual.global === expected.global &&\n           actual.multiline === expected.multiline &&\n           actual.lastIndex === expected.lastIndex &&\n           actual.ignoreCase === expected.ignoreCase;\n\n  // 7.4. Other pairs that do not both pass typeof value == 'object',\n  // equivalence is determined by ==.\n  } else if ((actual === null || typeof actual !== 'object') &&\n             (expected === null || typeof expected !== 'object')) {\n    return strict ? actual === expected : actual == expected;\n\n  // If both values are instances of typed arrays, wrap their underlying\n  // ArrayBuffers in a Buffer each to increase performance\n  // This optimization requires the arrays to have the same type as checked by\n  // Object.prototype.toString (aka pToString). Never perform binary\n  // comparisons for Float*Arrays, though, since e.g. +0 === -0 but their\n  // bit patterns are not identical.\n  } else if (isView(actual) && isView(expected) &&\n             pToString(actual) === pToString(expected) &&\n             !(actual instanceof Float32Array ||\n               actual instanceof Float64Array)) {\n    return compare(new Uint8Array(actual.buffer),\n                   new Uint8Array(expected.buffer)) === 0;\n\n  // 7.5 For all other Object pairs, including Array objects, equivalence is\n  // determined by having the same number of owned properties (as verified\n  // with Object.prototype.hasOwnProperty.call), the same set of keys\n  // (although not necessarily the same order), equivalent values for every\n  // corresponding key, and an identical 'prototype' property. Note: this\n  // accounts for both named and indexed properties on Arrays.\n  } else if (isBuffer(actual) !== isBuffer(expected)) {\n    return false;\n  } else {\n    memos = memos || {actual: [], expected: []};\n\n    var actualIndex = memos.actual.indexOf(actual);\n    if (actualIndex !== -1) {\n      if (actualIndex === memos.expected.indexOf(expected)) {\n        return true;\n      }\n    }\n\n    memos.actual.push(actual);\n    memos.expected.push(expected);\n\n    return objEquiv(actual, expected, strict, memos);\n  }\n}\n\nfunction isArguments(object) {\n  return Object.prototype.toString.call(object) == '[object Arguments]';\n}\n\nfunction objEquiv(a, b, strict, actualVisitedObjects) {\n  if (a === null || a === undefined || b === null || b === undefined)\n    return false;\n  // if one is a primitive, the other must be same\n  if (util.isPrimitive(a) || util.isPrimitive(b))\n    return a === b;\n  if (strict && Object.getPrototypeOf(a) !== Object.getPrototypeOf(b))\n    return false;\n  var aIsArgs = isArguments(a);\n  var bIsArgs = isArguments(b);\n  if ((aIsArgs && !bIsArgs) || (!aIsArgs && bIsArgs))\n    return false;\n  if (aIsArgs) {\n    a = pSlice.call(a);\n    b = pSlice.call(b);\n    return _deepEqual(a, b, strict);\n  }\n  var ka = objectKeys(a);\n  var kb = objectKeys(b);\n  var key, i;\n  // having the same number of owned properties (keys incorporates\n  // hasOwnProperty)\n  if (ka.length !== kb.length)\n    return false;\n  //the same set of keys (although not necessarily the same order),\n  ka.sort();\n  kb.sort();\n  //~~~cheap key test\n  for (i = ka.length - 1; i >= 0; i--) {\n    if (ka[i] !== kb[i])\n      return false;\n  }\n  //equivalent values for every corresponding key, and\n  //~~~possibly expensive deep test\n  for (i = ka.length - 1; i >= 0; i--) {\n    key = ka[i];\n    if (!_deepEqual(a[key], b[key], strict, actualVisitedObjects))\n      return false;\n  }\n  return true;\n}\n\n// 8. The non-equivalence assertion tests for any deep inequality.\n// assert.notDeepEqual(actual, expected, message_opt);\n\nassert.notDeepEqual = function notDeepEqual(actual, expected, message) {\n  if (_deepEqual(actual, expected, false)) {\n    fail(actual, expected, message, 'notDeepEqual', assert.notDeepEqual);\n  }\n};\n\nassert.notDeepStrictEqual = notDeepStrictEqual;\nfunction notDeepStrictEqual(actual, expected, message) {\n  if (_deepEqual(actual, expected, true)) {\n    fail(actual, expected, message, 'notDeepStrictEqual', notDeepStrictEqual);\n  }\n}\n\n\n// 9. The strict equality assertion tests strict equality, as determined by ===.\n// assert.strictEqual(actual, expected, message_opt);\n\nassert.strictEqual = function strictEqual(actual, expected, message) {\n  if (actual !== expected) {\n    fail(actual, expected, message, '===', assert.strictEqual);\n  }\n};\n\n// 10. The strict non-equality assertion tests for strict inequality, as\n// determined by !==.  assert.notStrictEqual(actual, expected, message_opt);\n\nassert.notStrictEqual = function notStrictEqual(actual, expected, message) {\n  if (actual === expected) {\n    fail(actual, expected, message, '!==', assert.notStrictEqual);\n  }\n};\n\nfunction expectedException(actual, expected) {\n  if (!actual || !expected) {\n    return false;\n  }\n\n  if (Object.prototype.toString.call(expected) == '[object RegExp]') {\n    return expected.test(actual);\n  }\n\n  try {\n    if (actual instanceof expected) {\n      return true;\n    }\n  } catch (e) {\n    // Ignore.  The instanceof check doesn't work for arrow functions.\n  }\n\n  if (Error.isPrototypeOf(expected)) {\n    return false;\n  }\n\n  return expected.call({}, actual) === true;\n}\n\nfunction _tryBlock(block) {\n  var error;\n  try {\n    block();\n  } catch (e) {\n    error = e;\n  }\n  return error;\n}\n\nfunction _throws(shouldThrow, block, expected, message) {\n  var actual;\n\n  if (typeof block !== 'function') {\n    throw new TypeError('\"block\" argument must be a function');\n  }\n\n  if (typeof expected === 'string') {\n    message = expected;\n    expected = null;\n  }\n\n  actual = _tryBlock(block);\n\n  message = (expected && expected.name ? ' (' + expected.name + ').' : '.') +\n            (message ? ' ' + message : '.');\n\n  if (shouldThrow && !actual) {\n    fail(actual, expected, 'Missing expected exception' + message);\n  }\n\n  var userProvidedMessage = typeof message === 'string';\n  var isUnwantedException = !shouldThrow && util.isError(actual);\n  var isUnexpectedException = !shouldThrow && actual && !expected;\n\n  if ((isUnwantedException &&\n      userProvidedMessage &&\n      expectedException(actual, expected)) ||\n      isUnexpectedException) {\n    fail(actual, expected, 'Got unwanted exception' + message);\n  }\n\n  if ((shouldThrow && actual && expected &&\n      !expectedException(actual, expected)) || (!shouldThrow && actual)) {\n    throw actual;\n  }\n}\n\n// 11. Expected to throw an error:\n// assert.throws(block, Error_opt, message_opt);\n\nassert.throws = function(block, /*optional*/error, /*optional*/message) {\n  _throws(true, block, error, message);\n};\n\n// EXTENSION! This is annoying to write outside this module.\nassert.doesNotThrow = function(block, /*optional*/error, /*optional*/message) {\n  _throws(false, block, error, message);\n};\n\nassert.ifError = function(err) { if (err) throw err; };\n\n// Expose a strict only variant of assert\nfunction strict(value, message) {\n  if (!value) fail(value, true, message, '==', strict);\n}\nassert.strict = objectAssign(strict, assert, {\n  equal: assert.strictEqual,\n  deepEqual: assert.deepStrictEqual,\n  notEqual: assert.notStrictEqual,\n  notDeepEqual: assert.notDeepStrictEqual\n});\nassert.strict.strict = assert.strict;\n\nvar objectKeys = Object.keys || function (obj) {\n  var keys = [];\n  for (var key in obj) {\n    if (hasOwn.call(obj, key)) keys.push(key);\n  }\n  return keys;\n};\n","/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n","'use strict';\n\nconst WINDOW = Symbol('window');\nconst BUCKETS = Symbol('buckets');\nconst TIMEOUT = Symbol('timeout');\nconst PERCENTILES = Symbol('percentiles');\nconst BUCKET_INTERVAL = Symbol('bucket-interval');\nconst SNAPSHOT_INTERVAL = Symbol('snapshot-interval');\n\nconst EventEmitter = require('events').EventEmitter;\n\n/**\n * Tracks execution status for a given {@link CircuitBreaker}.\n * A Status instance is created for every {@link CircuitBreaker}\n * and does not typically need to be created by a user.\n *\n * A Status instance will listen for all events on the {@link CircuitBreaker}\n * and track them in a rolling statistical window. The window duration is\n * determined by the `rollingCountTimeout` option provided to the\n * {@link CircuitBreaker}. The window consists of an array of Objects,\n * each representing the counts for a {@link CircuitBreaker}'s events.\n *\n * The array's length is determined by the {@link CircuitBreaker}'s\n * `rollingCountBuckets` option. The duration of each slice of the window\n * is determined by dividing the `rollingCountTimeout` by\n * `rollingCountBuckets`.\n *\n * @class Status\n * @extends EventEmitter\n * @param {Object} options for the status window\n * @param {Number} options.rollingCountBuckets number of buckets in the window\n * @param {Number} options.rollingCountTimeout the duration of the window\n * @param {Boolean} options.rollingPercentilesEnabled whether to calculate\n * percentiles\n * @param {Object} options.stats object of previous stats\n * @example\n * // Creates a 1 second window consisting of ten time slices,\n * // each 100ms long.\n * const circuit = circuitBreaker(fs.readFile,\n *  { rollingCountBuckets: 10, rollingCountTimeout: 1000});\n *\n * // get the cumulative statistics for the last second\n * circuit.status.stats;\n *\n * // get the array of 10, 1 second time slices for the last second\n * circuit.status.window;\n * @fires Status#snapshot\n * @see CircuitBreaker#status\n */\nclass Status extends EventEmitter {\n  constructor (options) {\n    super();\n\n    // Set up our statistical rolling window\n    this[BUCKETS] = options.rollingCountBuckets || 10;\n    this[TIMEOUT] = options.rollingCountTimeout || 10000;\n    this[WINDOW] = new Array(this[BUCKETS]);\n    this[PERCENTILES] = [0.0, 0.25, 0.5, 0.75, 0.9, 0.95, 0.99, 0.995, 1];\n\n    // Default this value to true\n    this.rollingPercentilesEnabled =\n    options.rollingPercentilesEnabled !== false;\n\n    // prime the window with buckets\n    for (let i = 0; i < this[BUCKETS]; i++) this[WINDOW][i] = bucket();\n\n    // rotate the buckets periodically\n    const bucketInterval = Math.floor(this[TIMEOUT] / this[BUCKETS]);\n    this[BUCKET_INTERVAL] = setInterval(nextBucket(this[WINDOW]),\n      bucketInterval);\n\n    // No unref() in the browser\n    if (typeof this[BUCKET_INTERVAL].unref === 'function') {\n      this[BUCKET_INTERVAL].unref();\n    }\n\n    /**\n     * Emitted at each time-slice. Listeners for this\n     * event will receive a cumulative snapshot of the current status window.\n     * @event Status#snapshot\n     * @type {Object}\n     */\n    this[SNAPSHOT_INTERVAL] = setInterval(\n      _ => this.emit('snapshot', this.stats),\n      bucketInterval);\n    if (typeof this[SNAPSHOT_INTERVAL].unref === 'function') {\n      this[SNAPSHOT_INTERVAL].unref();\n    }\n\n    if (options.stats) {\n      this[WINDOW][0] = { ...bucket(), ...options.stats };\n    }\n  }\n\n  /**\n   * Get the cumulative stats for the current window\n   * @type {Object}\n   */\n  get stats () {\n    const totals = this[WINDOW].reduce((acc, val) => {\n      if (!val) { return acc; }\n      Object.keys(acc).forEach(key => {\n        if (key !== 'latencyTimes' && key !== 'percentiles') {\n          (acc[key] += val[key] || 0);\n        }\n      });\n\n      if (this.rollingPercentilesEnabled) {\n        acc.latencyTimes.push.apply(acc.latencyTimes, val.latencyTimes || []);\n      }\n      return acc;\n    }, bucket());\n\n    if (this.rollingPercentilesEnabled) {\n      // Sort the latencyTimes\n      totals.latencyTimes.sort((a, b) => a - b);\n\n      // Get the mean latency\n      // Mean = sum of all values in the array/length of array\n      if (totals.latencyTimes.length) {\n        totals.latencyMean =\n          (totals\n            .latencyTimes\n            .reduce((a, b) => a + b, 0)) / totals.latencyTimes.length;\n      } else {\n        totals.latencyMean = 0;\n      }\n\n      // Calculate Percentiles\n      this[PERCENTILES].forEach(percentile => {\n        totals.percentiles[percentile] =\n          calculatePercentile(percentile, totals.latencyTimes);\n      });\n    } else {\n      totals.latencyMean = -1;\n      this[PERCENTILES].forEach(percentile => {\n        totals.percentiles[percentile] = -1;\n      });\n    }\n\n    return totals;\n  }\n\n  /**\n   * Gets the stats window as an array of time-sliced objects.\n   * @type {Array}\n   */\n  get window () {\n    return this[WINDOW].slice();\n  }\n\n  increment (property, latencyRunTime) {\n    this[WINDOW][0][property]++;\n    if (property === 'successes' ||\n        property === 'failures' ||\n        property === 'timeouts') {\n      this[WINDOW][0].latencyTimes.push(latencyRunTime || 0);\n    }\n  }\n\n  open () {\n    this[WINDOW][0].isCircuitBreakerOpen = true;\n  }\n\n  close () {\n    this[WINDOW][0].isCircuitBreakerOpen = false;\n  }\n\n  shutdown () {\n    this.removeAllListeners();\n    clearInterval(this[BUCKET_INTERVAL]);\n    clearInterval(this[SNAPSHOT_INTERVAL]);\n  }\n}\n\nconst nextBucket = window => _ => {\n  window.pop();\n  window.unshift(bucket());\n};\n\nconst bucket = _ => ({\n  failures: 0,\n  fallbacks: 0,\n  successes: 0,\n  rejects: 0,\n  fires: 0,\n  timeouts: 0,\n  cacheHits: 0,\n  cacheMisses: 0,\n  semaphoreRejections: 0,\n  percentiles: {},\n  latencyTimes: []\n});\n\nfunction calculatePercentile (percentile, arr) {\n  if (percentile === 0) {\n    return arr[0] || 0;\n  }\n  const idx = Math.ceil(percentile * arr.length);\n  return arr[idx - 1] || 0;\n}\n\nmodule.exports = exports = Status;\n","'use strict';\n\nmodule.exports = exports = semaphore;\n\nfunction semaphore (count) {\n  const resolvers = [];\n  let counter = count;\n\n  const sem = {\n    take,\n    release,\n    test\n  };\n\n  Object.defineProperty(sem, 'count', {\n    get: _ => counter,\n    enumerable: true\n  });\n\n  return sem;\n\n  function take (timeout) {\n    if (counter > 0) {\n      --counter;\n      return Promise.resolve(release);\n    }\n    return new Promise((resolve, reject) => {\n      resolvers.push(_ => {\n        --counter;\n        resolve(release);\n      });\n      if (timeout) {\n        setTimeout(_ => {\n          resolvers.shift();\n          const err = new Error(`Timed out after ${timeout}ms`);\n          err.code = 'ETIMEDOUT';\n          reject(err);\n        }, timeout);\n      }\n    });\n  }\n\n  function release () {\n    counter++;\n    if (resolvers.length > 0) {\n      resolvers.shift()();\n    }\n  }\n\n  function test () {\n    if (counter < 1) return false;\n    return take() && true;\n  }\n}\n"],"sourceRoot":""}