"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.enhanceData = void 0;
const defaults_1 = require("../common/defaults");
/**
 * Enhances the provided custom page configuration with default data.
 *
 * @param {CustomPage} data - a custom page configuration object
 * @param manifestPath - path to the application manifest
 * @param fs - mem-fs reference to be used for file access
 * @returns enhanced configuration
 */
function enhanceData(data, manifestPath, fs) {
    var _a, _b, _c, _d, _e, _f;
    const manifest = fs.readJSON(manifestPath);
    // set common defaults
    const config = defaults_1.setCommonDefaults(data, manifestPath, manifest);
    // if FCL is enabled enhance the configuration
    if (((_c = (_b = (_a = manifest['sap.ui5']) === null || _a === void 0 ? void 0 : _a.routing) === null || _b === void 0 ? void 0 : _b.config) === null || _c === void 0 ? void 0 : _c.routerClass) === defaults_1.FCL_ROUTER) {
        config.fcl = true;
        if (config.navigation) {
            const sourceRoute = (((_e = (_d = manifest['sap.ui5']) === null || _d === void 0 ? void 0 : _d.routing) === null || _e === void 0 ? void 0 : _e.routes) || []).find((route) => { var _a; return route.name === ((_a = config.navigation) === null || _a === void 0 ? void 0 : _a.sourcePage); });
            config.controlAggregation =
                ((_f = sourceRoute === null || sourceRoute === void 0 ? void 0 : sourceRoute.target) !== null && _f !== void 0 ? _f : []).length > 1 ? 'endColumnPages' : 'midColumnPages';
        }
        else {
            config.controlAggregation = 'beginColumnPages';
        }
    }
    if (config.view === undefined) {
        config.view = {
            title: config.name
        };
    }
    return config;
}
exports.enhanceData = enhanceData;
//# sourceMappingURL=defaults.js.map